@page "/Album"
@using JxAudio.TransVo
@using JxAudio.Front.Components
@using Console = System.Console

@inject HttpClient Http

<PageTitle>专辑</PageTitle>

<FrontTable TItem="AlbumVo" OnQueryAsync="OnQueryAsync">
    <TableColumns>
        <TableColumn @bind-Field="@context.CoverId">
            <Template Context="value">
                <Avatar Url="@($"/api/Cover?coverId={value.Value}")"></Avatar>
            </Template>
        </TableColumn>
        <TableColumn @bind-Field="@context.Title" Searchable="true" Sortable="true" Filterable="true"></TableColumn>
        <TableColumn @bind-Field="@context.ArtistName" Searchable="true" Sortable="true" Filterable="true"></TableColumn>
        <TableColumn @bind-Field="@context.Count"></TableColumn>
        <TableColumn @bind-Field="@context.TotalSize" Sortable="true"></TableColumn>
    </TableColumns>
</FrontTable>

@code {
    

    private async Task<QueryData<AlbumVo>> OnQueryAsync(QueryPageOptions queryPageOptions)
    {
        var responseMessage = await Http.PostAsJsonAsync("/api/Album", queryPageOptions);
        var vo = await responseMessage.Content.ReadFromJsonAsync<QueryData<AlbumVo>>();
        if (vo == null)
        {
            return new QueryData<AlbumVo>();
        }

        return vo;
    }

}